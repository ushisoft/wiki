# Java

Java面试相关准备及总结。

## 代码规范

### 面试要点

- 字迹工整，书写清楚

- 合理的布局，清晰的缩进

- 合理的命名，见名知义

- 代码完整

### 面试题目参考

- [二分查找](http://blog.csdn.net/q3498233/article/details/4419285)
- [排序](http://blog.csdn.net/davebobo/article/details/51170177)
- 多线程和控制（暂停，恢复，停止）
- 生产者消费者
- 已知用户、角色、权限，判断权限
- [其他](http://blog.csdn.net/qq_17612199/article/details/52606209)


### 源代码展示

- github


- 自带


- 手写，提示面试要点在规范及思维过程

## 逻辑思维

### 授信额度的使用

1. 题目：

   公司A给予授信额度若干，放款时会使用授信额度，还款时会释放授信额度，描述大致实现。

2. 要点：

   正确的逻辑；

   并发时的处理。

3. 额外加分：

   冻结逻辑

### 合同模版的设计

1. 题目：

   如何通过模版的管理，规范合同生成的过程，描述大致解决方案。

2. 要点：

   正确的逻辑；

   空怎么填；

   要素怎么保存。

3. 额外加分：

   字典逻辑

## Java相关

### Java基础

#### 语法

JDK、JRE的区别

重载和重写的区别

java、javac分别做什么？

变量的作用域和生命周期

#### 堆栈

##### Java虚拟机栈（Java Virtual Machine Stacks）

虚拟机栈描述的是Java方法执行的内存模型：每个方法被执行的时候都会同时创建一个栈帧（Stack Frame）用于存储局部变量表、操作栈、动态链接、方法出口等信息。每一个方法被调用直至执行完成的过程，就对应着一个栈帧在虚拟机栈中从入栈到出栈的过程。

##### 本地方法栈

与虚拟机栈类似，为Native方法服务。

##### Java堆

Java堆是被所有线程共享的一块内存区域，在虚拟机启动时创建。

此内存区域的唯一目的就是存放对象实例。

Java堆是垃圾收集器管理的主要区域，因此很多时候也被称做"GC堆"。

通过-Xmx和-Xms控制。

##### 方法区（Method Area）

与Java堆一样，是各个线程共享的内存区域，它用于存储已被虚拟机加载的类信息、常量、静态变量、即时编译器编译后的代码等数据。

虽然Java虚拟机规范把方法区描述为堆的一个逻辑部分，但是它却有一个别名叫做Non-Heap（非堆），目的应该是与Java堆区分开来。

#### 面向对象

##### 匿名对象

什么是匿名对象，什么时候使用？

##### 构造代码块

```java
public class Demo {
  static {
    System.out.println("这是静态代码块");
  }
  {
    System.out.println("这是构造代码块");
  }
  public Demo() {
    System.out.println("这是一个无参数构造方法");
  }
}
```

执行顺序：静态代码块>main方法>构造代码块>构造方法。

静态代码块只执行一次，比如在调用C语言动态库的代码可以放在此处。

构造代码块可以放一些不同构造方法间有共性的部分代码，不常使用。

##### 创建对象的过程

如下，创建对象时，在内存中做了什么事情？

```java
Person p = new Person();
```

1：先将硬盘上指定位置的Person.class文件加载进内存。

2：执行main方法时，在栈内存中开辟了main方法的空间(压栈-进栈)，然后在main方法的栈区分配了一个变量p。

3：在堆内存中开辟一个实体空间，分配了一个内存首地址值。

4：在该实体空间中进行属性的空间分配，并进行了默认初始化。

5：对空间中的属性进行显示初始化。

6：进行实体的构造代码块初始化。

7：调用该实体对应的构造函数，进行构造函数初始化。

8：将首地址赋值给p ，p变量就引用了该实体。(指向了该对象)

##### 生成Java帮助文档

```shell
javadoc -d 文件夹名 -auther -version *.java
```

##### 具体方法

下面这个方法的具体用途？

```java
int hashCode();
```



### Spring基础

#### Java反射知识

简单描述

包含哪些反射对象：Constructor、Method、Field

如何访问private、protected成员变量和方法：setAccessible(boolean access)


#### Java动态代理／AOP

两种代理机制

- 基于JDK


- 基于CGLib

两种代理机制的差别

- JDK只代理接口



- CGLib性能高



- JDK创建对象开销小



- CGLib通过创建子类代理，所以无法代理final方法

#### XML配置基础

简述Schema命名空间的定义结构

指定Schema命名空间的两个用途

- 格式合法性验证



- IDE代码提示

#### ThreadLocal

简述工作原理

- 副本



- 使用Map，Key为线程对象，值为变量副本

简述与Thread同步机制相比，解决并发问题时的不同

#### 数据库事务

数据库事务的4 个特性

- 原子性（Atomic）



- 一致性（Consistency）



- 隔离性（Isolation）：多种事务隔离级别，隔离级别越高，数据一致性越好，并发性越弱



- 持久性（Durabiliy）：持久化

#### 数据并发问题

##### 脏读（dirty read）

| 时间   | 转账事务A           | 取款事务B           |
| ---- | --------------- | --------------- |
| T1   |                 | 开始事务            |
| T2   | 开始事务            |                 |
| T3   |                 | 查询账户余额为1000元    |
| T4   |                 | 取出500元，改余额为500元 |
| T5   | 查询账户余额为500元（脏读） |                 |
| T6   |                 | 撤销事务余额恢复为1000元  |
| T7   | 汇入100元，改余额为600元 |                 |
| T8   | 提交事务            |                 |

> 一个有结巴的人在饮料店柜台前转悠，老板很热情地迎上来说：“喝一瓶？”结巴连忙说：“我…喝…喝…”老板麻利地打开易拉罐递给结巴，结巴终于憋出了他的那句话：“我…喝…喝…喝不起啊！”

##### 不可重复读（unrepeatable read）

| 时间   | 取款事务A                | 转账事务B           |
| ---- | -------------------- | --------------- |
| T1   |                      | 开始事务            |
| T2   | 开始事务                 |                 |
| T3   |                      | 查询余额为1000元      |
| T4   | 查询余额为1000元           |                 |
| T5   |                      | 取出100元，改余额为900元 |
| T6   |                      | 提交事务            |
| T7   | 查询余额为900元（与T4读取的不一致） |                 |

##### 幻读（phantom read）

| 时间   | 统计金额事务A          | 转账事务B       |
| ---- | ---------------- | ----------- |
| T1   |                  | 开始事务        |
| T2   | 开始事务             |             |
| T3   | 统计总存款为10000元     |             |
| T4   |                  | 新增账户，存款100元 |
| T5   |                  | 提交事务        |
| T6   | 再次统计，为10100元（幻读） |             |

幻读和不可重复读是两个容易混淆的概念，可重复读与不可重复读关注的在于某条数据，而幻读与否关注的是整个表之内的增删操作。

为防止幻读，往往需要添加表级锁，将整个表锁定。

##### 第一类丢失更新

| 时间   | 取款事务A            | 转账事务B          |
| ---- | ---------------- | -------------- |
| T1   | 开始事务             |                |
| T2   |                  | 开始事务           |
| T3   | 查询余额为1000元       |                |
| T4   |                  | 查询余额为1000元     |
| T5   |                  | 汇入100，计余额1100元 |
| T6   |                  | 提交事务           |
| T7   | 取出100，计余额为900元   |                |
| T8   | 撤销事务             |                |
| T9   | 余额恢复为1000元（丢失更新） |                |

##### 第二类丢失更新

| 时间   | 取款事务A           | 转账事务B         |
| ---- | --------------- | ------------- |
| T1   | 开始事务            |               |
| T2   |                 | 开始事务          |
| T3   | 查询余额为1000元      |               |
| T4   |                 | 查询余额为1000元    |
| T5   |                 | 取出100，计余额900元 |
| T6   |                 | 提交事务          |
| T7   | 汇入100           |               |
| T8   | 提交事务            |               |
| T9   | 余额计为1100元（丢失更新） |               |

##### 不同隔离级别的并发问题

| 隔离级别                   | 脏读   | 不可重复读 | 幻读   | 第一类  | 第二类  |
| ---------------------- | ---- | ----- | ---- | ---- | ---- |
| 未提交读（Read uncommitted） | Y    | Y     | Y    | N    | Y    |
| 已提交读（Read committed）   | N    | Y     | Y    | N    | Y    |
| 可重复读（Repeatable read）  | N    | N     | Y    | N    | N    |
| 可串行化（Serializable ）    | N    | N     | N    | N    | N    |

##### 数据库锁机制

大致有哪些锁？

锁之间的兼容性如何？

什么时候会发生死锁？如何解决？

#### HTTP报文

报文的大致组成

常用的报文头属性

常用的错误码

- 200 OK


- 303 See Other


- 304 Not Modified


- 404 Not Found


- 500 Internal Server Error





## 架构设计基础

分布式事务

分布式日志

分布式文件

## 操作系统及网络基础

